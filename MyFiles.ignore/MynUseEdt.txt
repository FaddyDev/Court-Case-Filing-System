
<?php require_once('includes/header.php'); //include the template top
include_once("includes/dbconn.php"); ?>
<?php 
 ?>
 <script src="jquery.js"></script>
<script type="text/javascript">
$(document).ready(function() {
$("#submit").click(function() {
var cat = $("#category").val();
var user = $("#username").val();
var pass = $("#pass").val();
if (cat == '' || user == '' || pass == '') {
$('#success__para').html("Insertion Failed Some Input Fields are Blank....!!");
} else {
// Returns successful data submission message when the entered information is stored in database.
$.post("admin.php", {
 	category:cat,
   username:user,
   password:pass
  }, function(data) {
  if (data != 'New User Added'){alert(data);}
//$('#success__para').text(data);
else{
//alert(data);
$('#admin')[0].reset(); // To reset form fields
}
});
}
});
});

function checkPasswordMatch1() {
    var submt = document.getElementById("submit");
    var password = $("#pass").val();
    var confirmPassword = $("#pass2").val();
	
	if(confirmPassword == ''){ $("#divCheckPasswordMatch").html("");
		submt.style.display = 'none';}
	else{
    if (password != confirmPassword){
        $("#divCheckPasswordMatch").html("<font color='red'>Passwords do not match!</font>");
		submt.style.display = 'none';}
    else{
        $("#divCheckPasswordMatch").html("Passwords match.");
		submt.style.display = 'block';}
		}
}


function checkPasswordMatch() {
    var submt = document.getElementById("submit");
    var password = $("#pass").val();
    var confirmPassword = $("#pass2").val();
	
	if(password == ''){ $("#divCheckPasswordMatch").html("");
		submt.style.display = 'none';}
	else{
    if (password != confirmPassword){
        $("#divCheckPasswordMatch").html("<font color='red'>Passwords do not match!</font>");
		submt.style.display = 'none';}
    else{
        $("#divCheckPasswordMatch").html("Passwords match.");
		submt.style.display = 'block';}
		}
}

function confirm_pass(){
	var password = $("#pass").val();
    var confirmPassword = $("#pass2").val();
	 
	 if(password!=confirmPassword){
		 alert('Passwords do not match');
		 return false;
		 }
	
	 return true;
	 }
	 
function admin(){
 var c = document.getElementById("category");
 var u = document.getElementById("username");
var cat = c.options[c.selectedIndex].text;
if (cat == 'Admin'){
 //$("#username").html("Passwords match.");
 u.value='Admin';
 u.readOnly = true;
}
else{
 u.value='';
  u.readOnly = false;
}
//alert(cat);
}
</script>

<div class="container">
<p align="center" style="color:#FF0000;" id="success_para" ></p>
<hr>
<div class="col-md-4">
<!--<h2>Add Users</h2>-->
<fieldset><legend>Add Users</legend>
<form class="form-horizontal well" id="admin" action="admin.php" method="post" onsubmit="return confirm_pass();">

					
<tr><td> <select class="form-control" name="category" id="category" onchange="return admin();" required>
		  <option value="">Select Court</option>
             <option value="High_Court">High Court</option>
			 <option value="Magistrate_Courts">Chief Magistrate's Courts</option>
			 <option value="ELC">ELC</option>
			 <option value="admin">Admin</option>
			 </select></td></tr>
 <tr><td><input class="form-control add-todo" type="text" autocomplete="off" placeholder="Username: PJ Number" id="username" name="username" required/></td></tr>
 <tr><td><input class="form-control add-todo" type="text" autocomplete="off" placeholder="Enter password: ID No" id="pass" name="pass" onkeyup="checkPasswordMatch1();" required/></td></tr>
  <tr><td><input class="form-control add-todo" type="text" autocomplete="off" placeholder="Re-Enter password: ID No" id="pass2" onkeyup="checkPasswordMatch();" name="pass2" required/></td></tr>
         <div class="registrationFormAlert" id="divCheckPasswordMatch"></div>
        </table>
            
		<input type="reset" class="btn btn-primary"  style="float: left;" value="Reset All" />
        <input type="submit" class="btn btn-primary" style="float: right;" value="Submit" id="submit" name="registerbtn" /> 
		</form> 
		</fieldset>
</div>

<div class="col-md-8">
<!--<h2>gvhg</h2> -->
<input style="float:right;" type="text" id="searchTerm" class="search_box form-control add-todo" placeholder="Type to search..." onkeyup="doSearch()" />
<table id="dataTable" class="table table-striped table-bordered table-hover table-condensed table-responsive display">
<tbody>
<tr><th>Category/Court</th><th>Username (PJ)</th><th>Password</th>
<?php if(isset($_SESSION["loggedin"]) & $_SESSION["username"] == 'Admin'){?><th colspan="2">Action</th><?php }?></tr>
<?php 
$sql = '';
if(isset($_SESSION["loggedin"])){ $sql="SELECT * FROM users ORDER BY category"; }
$result=$conn->query($sql);
if($result->num_rows>0){
while($row=$result->fetch_assoc()){
echo "<tr> 
<td> ".str_replace("_"," ",$row["category"])." </td>
<td> ".$row["username"]." </td> 
<td> ".$row["password"]."</td>";

if(isset($_SESSION["loggedin"])){
echo "<td>  <a href='editUser.php?edit=$row[sr]'>Edit</a></td>
<td>  <a href='javascript:confirmDeleteUser($row[sr])'>Delete</a></td>"; }
echo "</tr>";}
echo "</tbody></table> ";

}
else{
//When table is empty
?>
<table id="dataTable" class="table table-striped table-bordered table-hover table-condensed table-responsive display">
<tr><th>No users</th></tr></table><? }

/*echo ("<script language='javascript'> window.alert('There are no cases in the system')</script>"); 
	if(!(isset($_SESSION["loggedin"]))){ echo "<meta http-equiv='refresh' content='0;url=addcase.php'> ";}
else{echo "<meta http-equiv='refresh' content='0;url=addcase.php'> ";}
*/
}
?>

</div>

 <hr> 
</div>
  
<?php require_once('includes/footer.php'); //include footer template ?>
$(document).ready(function() {
$("#submit").click(function() {
var cat = $("#category").val();
var user = $("#username").val();
var pass = $("#pass").val();
var pass2 = $("#pass2").val();
var passwd = '';
var case_id = $("#id").val();

if (pass2 == ''){ passwd = pass} else{ passwd = pass2}
if (cat == '' || user == '' || passwd == '' || case_id == '') {
$('#success__para').html("Insertion Failed Some Input Fields are Blank....!!");
} else {
// Returns successful data submission message when the entered information is stored in database.
$.post("editUser.php", {
 	category:cat,
   username:user,
   password:passwd
  }, function(data) {
  if (data != 'New User Added'){alert(data);}
//$('#success__para').text(data);
else{
//alert(data);
//$('#editUser')[0].reset(); // To reset form fields
window.location.href = 'admin.php';
}
});
}
});
});
